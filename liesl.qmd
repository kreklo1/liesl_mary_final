---
output: html_document
editor_options: 
  chunk_output_type: console
---

## Libraries
```{r}
library(tidyverse)
library(ggplot2)
library(leaflet)
library(readr)
library(wordcloud)
library(stringr)
```

## Data
```{r}
parks <- read_csv("datasets/Parks_Properties_20240507.csv")
airbnb_data <- read_csv("datasets/airbnb_data.csv")
rats <- read_csv("datasets/Rat_Sightings_20240507.csv")
```


## Interactive Leaflet map
```{r}
leaflet() |>
    addTiles() |>
    setView(lng = mean(airbnb_data$Longitude), lat = mean(airbnb_data$Latitude), 
            zoom = 10) |> 
    addCircleMarkers(data = airbnb_data,
        lat = ~ Latitude, 
        lng = ~ Longitude, 
        popup = ~ Name, 
        radius = ~ 10,  
        weight = 3,
        color = "hotpink", 
        fillColor = "pink")
```
Concerns about this. 
  - Is there a way to display multiple things of information in the popup?
  
##Two variable comparisons
```{r}
airbnb_parsed <- airbnb_data |>
  select(Name, Title, Id, `Listing URL`, Price, Beds, Baths, Bedrooms, `Average Rating`, `Number of Reviews`, `More Details`, `Listing Type`, `Room Type Category`) |>
  mutate(price_parsed = parse_number(Price))
```


```{r}
airbnb_parsed |>
  ggplot(aes(y = price_parsed, x = `Average Rating`)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `Number of Reviews`, x = `Average Rating`)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `Number of Reviews`, x = price_parsed)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `More Details`)) +
  geom_bar() 
```

Interchangeable variables to implement with the shiny app
  - Price
  - Location (how)
  - Busyness (i don't think we can do this because that information is empty)
  - Review (done⭐) (done #)
    - # 
    - ⭐
  - Tags (e.g. guest favorite) (not a scatter plot variable)
  
## Word Cloud
```{r}
word <- airbnb_data |>
  select(Name) |>
  mutate(words = str_split(Name, "\\s+"))
```

```{r}
word_freq <- table(words)
word_freq
```




