---
output: html_document
editor_options: 
  chunk_output_type: console
---

## Libraries
```{r}
library(tidyverse)
library(ggplot2)
library(leaflet)
library(readr)
library(wordcloud)
library(stringr)
library(tidytext)
```

## Data
```{r}
parks <- read_csv("datasets/Parks_Properties_20240507.csv")
airbnb_data <- read_csv("datasets/airbnb_data.csv")
rats <- read_csv("datasets/Rat_Sightings_20240507.csv")
```


## Interactive Leaflet map
```{r}
leaflet() |>
    addTiles() |>
    setView(lng = mean(airbnb_data$Longitude), lat = mean(airbnb_data$Latitude), 
            zoom = 10) |> 
    addCircleMarkers(data = airbnb_data,
        lat = ~ Latitude, 
        lng = ~ Longitude, 
        popup = ~ Name, 
        radius = ~ 10,  
        weight = 3,
        color = "hotpink", 
        fillColor = "pink")
```
Concerns about this. 
  - Is there a way to display multiple things of information in the popup?
  
##Two variable comparisons
```{r}
airbnb_parsed <- airbnb_data |>
  select(Name, Title, Id, `Listing URL`, Price, Beds, Baths, Bedrooms, `Average Rating`, `Number of Reviews`, `More Details`, `Listing Type`, `Room Type Category`) |>
  mutate(price_parsed = parse_number(Price))
```


```{r}
airbnb_parsed |>
  ggplot(aes(y = price_parsed, x = `Average Rating`)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `Number of Reviews`, x = `Average Rating`)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `Number of Reviews`, x = price_parsed)) +
  geom_point() 
```
```{r}
airbnb_parsed |>
  ggplot(aes(y = `More Details`)) +
  geom_bar() 
```

Interchangeable variables to implement with the shiny app
  - Price
  - Location (how)
  - Review (done⭐) (done #)
    - # 
    - ⭐ 
  - Tags (e.g. guest favorite) (not a scatter plot variable)
  
## Word Cloud
```{r}
word <- airbnb_data |>
  select(Name) |>
  mutate(Name = str_to_lower(Name),
         word = str_split(Name, "\\s+"),
         word = gsub("([[:punct:]])(?=[^[:alnum:]]*$)", "", word, perl = TRUE)) |>
  unnest(word) |>
  anti_join(stop_words) |>
  count(word)

```
concerns: bdrm, bed room, bedroom BR are all meaning bedroom but they don't all say it the same way  
,
         words = str_remove_all(words, "")
```{r}
trytrytry <- str_split(airbnb_data$Name, "\\s+")[[1]]
trytrytry
#trying to figure it out
```

```{r}
word_freq <- table(words)
word_freq
```

```{r}
inputPanel(
  selectInput("n_breaks2", label = "Number of bins:",
              choices = c(5, 10, 15, 20, 25, 30), selected = 15),
  
  sliderInput("bw_adjust2", label = "Bandwidth adjustment:",
              min = 0.1, max = 3, value = 1.2, step = 0.1)
)

renderPlot({
 ggplot(data = airbnb_parsed, aes(y = `Number of Reviews`, x = price_parsed)) +
  geom_point()
})
```




