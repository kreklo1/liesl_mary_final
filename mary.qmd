---
output: html_document
editor_options: 
  chunk_output_type: console
---


```{r}
library(ggplot2)
library(dplyr)
library(tidyr)
library(lubridate)
library(stringr)
library(emojifont)
library(ggtext)
library(leaflet)
library(sf)
library(readr)
```

```{r}
airbnb_data <- read_csv("airbnb_data.csv")

rats <- read_csv("Rat_Sightings_20240507.csv")|>
  filter(Latitude!="NA",
         Longitude!="NA")

parks <- read_csv("Parks_Properties_20240507.csv")
```

```{r}
rats_location <- rats |>
  select(Latitude, Longitude) 

rats_location

rats_graph<-rats_location|>
  sample_n(225)  

```

```{r}
airbnb_location<-airbnb_data|>
  select(Latitude, Longitude)
```


```{r}
nyc_county_borders <- map_data("county", region = c("new york", "kings", "bronx", "queens", "richmond"))

nyc_county_plot <- ggplot() +
  geom_polygon(data = nyc_county_borders, aes(x = long, y = lat, group = group), fill = "white", color = "black") +
  coord_map(xlim = c(-74.3, -73.7), ylim = c(40.503, 40.95)) +
  theme_linedraw()

nyc_county_plot +
geom_point(data = rats_location, aes(x=Longitude, y=Latitude), alpha=0.2, color="hotpink")+
geom_point(data=airbnb_location, aes(x=Longitude, y=Latitude), color="black")

```


```{r}
house_icon <- makeIcon(
  iconUrl = "https://www.iconeasy.com/icon/png/System/Vista%20General/house.png",
  iconWidth = 30,
  iconHeight = 30
)

rat_icon <- makeIcon(
  iconUrl = "https://icons.iconarchive.com/icons/google/noto-emoji-animals-nature/256/22251-rat-icon.png",
  iconWidth = 28,
  iconHeight = 28
)

leaflet() |>
  addTiles() |>
  setView(lng = -74.00, lat = 40.71, zoom = 12) |>
  addMarkers(data = airbnb_location, lng = ~Longitude, lat = ~Latitude, icon = house_icon)|>
  addMarkers(data=rats_graph, lng=~Longitude, lat=~Latitude, icon = rat_icon)

```
